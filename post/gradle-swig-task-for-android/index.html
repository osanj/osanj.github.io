<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head>
  <link href="//gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="generator" content="Hugo 0.92.2" />

  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>Quick and Dirty Gradle Task for Android Projects Using Swig &middot; Just a Notepad</title>

  
  <link type="text/css" rel="stylesheet" href="https://osanj.github.io/css/print.css" media="print">
  <link type="text/css" rel="stylesheet" href="https://osanj.github.io/css/poole.css">
  <link type="text/css" rel="stylesheet" href="https://osanj.github.io/css/syntax.css">
  <link type="text/css" rel="stylesheet" href="https://osanj.github.io/css/hyde.css">
  
  <link type="text/css" rel="stylesheet" href="https://osanj.github.io/css/justified_text.css">
  
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Abril+Fatface|PT+Sans:400,400i,700">


  
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/apple-touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="/favicon.png">

  
  

  
  
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/katex.min.css" integrity="sha384-zh0CIslj+VczCZtlzBcjt5ppRcsAmDnRem7ESsYwWwg3m/OaJ2l4x7YBZl9Kxxib" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/katex.min.js" integrity="sha384-Rma6DA2IPUwhNxmrB/7S3Tno0YY7sFu9WSYMCuulLhIqYSGZ2gKCJWIqhBWqMQfh" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/contrib/auto-render.min.js" integrity="sha384-hCXGrW6PitJEwbkoStFjeJxv+fSOOQKOPbJxSfM6G5sWZjAyWhXiTIIAmQqnlLlh" crossorigin="anonymous"></script>
<script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement(document.body, {
          
          
          delimiters: [
              {left: '$$', right: '$$', display: true},
              {left: '$', right: '$', display: false},
              {left: '\\(', right: '\\)', display: false},
              {left: '\\[', right: '\\]', display: true}
          ],
          
          throwOnError : false
        });
    });
</script>

  
</head>

  <body class=" ">
  <aside class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      <a href="https://osanj.github.io/"><h1>Just a Notepad</h1></a>
      <p class="lead">
       For Stuff Worth Sharing 
      </p>
    </div>

    <nav>
      <ul class="sidebar-nav">
        <li><a href="https://osanj.github.io/">Home</a> </li>
        <li><a href="https://github.com/osanj/lava"> Lava </a></li><li><a href="/tags/"> Tags </a></li><li><a href="/about/"> About </a></li>
      </ul>
    </nav>

    <p>Â© 2020-2025 Jonas Schuepfer</p>
  </div>
</aside>

    <main class="content container">
    <div class="post">
  <h1>Quick and Dirty Gradle Task for Android Projects Using Swig</h1>
  <time datetime=2021-03-21T00:00:00Z class="post-date">Sun, Mar 21, 2021</time>
  <p>Swig is really great to wrap native projects. I have been working on wrapping native code in an Android app, figuring out how to run swig as part of the gradle build pipeline took me way too many google queries.</p>
<p>Below is the code I added to the respective <code>build.gradle</code>. Certainly not my proudest work and not a pro level gradle implementation for sure, but it gets the job done.
Swig should be installed, for Windows you might need to update the <code>commandLine</code> block and there is no autodetect for an outdated build, so clean the project if you modify your swig or native code ðŸš¿</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Java" data-lang="Java">def cppDir <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;${project.projectDir}/src/main/cpp&#34;</span>
ext<span style="color:#f92672">.</span><span style="color:#a6e22e">swigFile</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;${cppDir}/mylib.i&#34;</span>
ext<span style="color:#f92672">.</span><span style="color:#a6e22e">swigOutputSourceFile</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;${cppDir}/mylib.cpp&#34;</span>
ext<span style="color:#f92672">.</span><span style="color:#a6e22e">swigOutputJavaPackage</span> <span style="color:#f92672">=</span> <span style="color:#960050;background-color:#1e0010">&#39;</span>com<span style="color:#f92672">.</span><span style="color:#a6e22e">my</span><span style="color:#f92672">.</span><span style="color:#a6e22e">lib</span><span style="color:#960050;background-color:#1e0010">&#39;</span>
ext<span style="color:#f92672">.</span><span style="color:#a6e22e">swigOutputJavaPackageDir</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;${project.projectDir}/src/main/java/&#34;</span> <span style="color:#f92672">+</span> swigOutputJavaPackage<span style="color:#f92672">.</span><span style="color:#a6e22e">replace</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;.&#34;</span><span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;/&#34;</span><span style="color:#f92672">)</span>

task swig <span style="color:#f92672">{</span>
    doLast <span style="color:#f92672">{</span>
        println <span style="color:#e6db74">&#34;Removing ${swigOutputSourceFile}&#34;</span>
        delete swigOutputSourceFile
        println <span style="color:#e6db74">&#34;Removing ${swigOutputJavaPackageDir}/*&#34;</span>
        delete <span style="color:#a6e22e">fileTree</span><span style="color:#f92672">(</span>swigOutputJavaPackageDir<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
            include <span style="color:#e6db74">&#39;*&#39;</span>
        <span style="color:#f92672">}</span>
        def cmd <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;swig -v -java -c++ -package ${swigOutputJavaPackage} -outdir ${swigOutputJavaPackageDir} -o ${swigOutputSourceFile} ${swigFile}&#34;</span>
        println <span style="color:#e6db74">&#34;Running \&#34;${cmd}\&#34;&#34;</span>
        exec <span style="color:#f92672">{</span>
            commandLine <span style="color:#960050;background-color:#1e0010">&#39;</span>sh<span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#f92672">,</span> <span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#f92672">-</span>c<span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#f92672">,</span> <span style="color:#e6db74">&#34;mkdir -p ${swigOutputJavaPackageDir} &amp;&amp; ${cmd}&#34;</span>
        <span style="color:#f92672">}</span>
    <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span>

<span style="color:#75715e">// attach task into the Android build graph
</span><span style="color:#75715e"></span>tasks<span style="color:#f92672">.</span><span style="color:#a6e22e">whenTaskAdded</span> <span style="color:#f92672">{</span> task <span style="color:#f92672">-&gt;</span>
    <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>task<span style="color:#f92672">.</span><span style="color:#a6e22e">name</span><span style="color:#f92672">.</span><span style="color:#a6e22e">tokenize</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;:&#34;</span><span style="color:#f92672">).</span><span style="color:#a6e22e">last</span><span style="color:#f92672">()</span> in <span style="color:#f92672">[</span><span style="color:#960050;background-color:#1e0010">&#39;</span>externalNativeBuildCleanDebug<span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#f92672">,</span> <span style="color:#960050;background-color:#1e0010">&#39;</span>externalNativeBuildCleanRelease<span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#f92672">])</span> <span style="color:#f92672">{</span>
        task<span style="color:#f92672">.</span><span style="color:#a6e22e">dependsOn</span> swig
    <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span></code></pre></div>
</div>


    </main>

    
  </body>
</html>
